###############################################################################
#                                                                             #
# IAR ANSI C/C++ Compiler V6.30.1.53127/W32 for ARM     22/Dec/2013  00:47:35 #
# Copyright 1999-2011 IAR Systems AB.                                         #
#                                                                             #
#    Cpu mode     =  thumb                                                    #
#    Endian       =  little                                                   #
#    Source file  =  C:\Users\Administrator\Desktop\杨向军的K60模板_只有基本I #
#                    O操作\src\cpu\sysinit.c                                  #
#    Command line =  C:\Users\Administrator\Desktop\杨向军的K60模板_只有基本I #
#                    O操作\src\cpu\sysinit.c -lCN                             #
#                    C:\Users\Administrator\Desktop\杨向军的K60模板_只有基本I #
#                    O操作\build\SX_demo\FLASH\List\ -lB                      #
#                    C:\Users\Administrator\Desktop\杨向军的K60模板_只有基本I #
#                    O操作\build\SX_demo\FLASH\List\ -o                       #
#                    C:\Users\Administrator\Desktop\杨向军的K60模板_只有基本I #
#                    O操作\build\SX_demo\FLASH\Obj\ --no_cse --no_unroll      #
#                    --no_inline --no_code_motion --no_tbaa --no_clustering   #
#                    --no_scheduling --debug --endian=little --cpu=Cortex-M4  #
#                    -e --fpu=None --dlib_config "E:\Program Files (x86)\IAR  #
#                    Systems\Embedded Workbench 6.0\arm\INC\c\DLib_Config_Nor #
#                    mal.h" -I C:\Users\Administrator\Desktop\杨向军的K60模板 #
#                    _只有基本IO操作\build\SX_demo\..\ -I                     #
#                    C:\Users\Administrator\Desktop\杨向军的K60模板_只有基本I #
#                    O操作\build\SX_demo\..\..\src\common\ -I                 #
#                    C:\Users\Administrator\Desktop\杨向军的K60模板_只有基本I #
#                    O操作\build\SX_demo\..\..\src\cpu\ -I                    #
#                    C:\Users\Administrator\Desktop\杨向军的K60模板_只有基本I #
#                    O操作\build\SX_demo\..\..\src\drivers\ -I                #
#                    C:\Users\Administrator\Desktop\杨向军的K60模板_只有基本I #
#                    O操作\build\SX_demo\..\..\src\drivers\gpio\ -I           #
#                    C:\Users\Administrator\Desktop\杨向军的K60模板_只有基本I #
#                    O操作\build\SX_demo\..\..\src\drivers\wdog\ -I           #
#                    C:\Users\Administrator\Desktop\杨向军的K60模板_只有基本I #
#                    O操作\build\SX_demo\..\..\src\drivers\mcg\ -I            #
#                    C:\Users\Administrator\Desktop\杨向军的K60模板_只有基本I #
#                    O操作\build\SX_demo\..\..\src\drivers\uart\ -I           #
#                    C:\Users\Administrator\Desktop\杨向军的K60模板_只有基本I #
#                    O操作\build\SX_demo\..\..\src\drivers\lptmr\ -I          #
#                    C:\Users\Administrator\Desktop\杨向军的K60模板_只有基本I #
#                    O操作\build\SX_demo\..\..\src\drivers\LED\ -I            #
#                    C:\Users\Administrator\Desktop\杨向军的K60模板_只有基本I #
#                    O操作\build\SX_demo\..\..\src\drivers\fun\ -I            #
#                    C:\Users\Administrator\Desktop\杨向军的K60模板_只有基本I #
#                    O操作\build\SX_demo\..\..\src\drivers\FTM\ -I            #
#                    C:\Users\Administrator\Desktop\杨向军的K60模板_只有基本I #
#                    O操作\build\SX_demo\..\..\src\drivers\pit\ -I            #
#                    C:\Users\Administrator\Desktop\杨向军的K60模板_只有基本I #
#                    O操作\build\SX_demo\..\..\src\drivers\DIPswitch\ -I      #
#                    C:\Users\Administrator\Desktop\杨向军的K60模板_只有基本I #
#                    O操作\build\SX_demo\..\..\src\drivers\steer\ -I          #
#                    C:\Users\Administrator\Desktop\杨向军的K60模板_只有基本I #
#                    O操作\build\SX_demo\..\..\src\drivers\ccd\ -I            #
#                    C:\Users\Administrator\Desktop\杨向军的K60模板_只有基本I #
#                    O操作\build\SX_demo\..\..\src\drivers\dma\ -I            #
#                    C:\Users\Administrator\Desktop\杨向军的K60模板_只有基本I #
#                    O操作\build\SX_demo\..\..\src\drivers\motor\ -I          #
#                    C:\Users\Administrator\Desktop\杨向军的K60模板_只有基本I #
#                    O操作\build\SX_demo\..\..\src\platforms\ -I              #
#                    C:\Users\Administrator\Desktop\杨向军的K60模板_只有基本I #
#                    O操作\build\SX_demo\..\..\src\projects\ -I               #
#                    C:\Users\Administrator\Desktop\杨向军的K60模板_只有基本I #
#                    O操作\build\SX_demo\..\..\src\projects\SX_demo\ -Ol      #
#    List file    =  C:\Users\Administrator\Desktop\杨向军的K60模板_只有基本I #
#                    O操作\build\SX_demo\FLASH\List\sysinit.lst               #
#    Object file  =  C:\Users\Administrator\Desktop\杨向军的K60模板_只有基本I #
#                    O操作\build\SX_demo\FLASH\Obj\sysinit.o                  #
#                                                                             #
#                                                                             #
###############################################################################

C:\Users\Administrator\Desktop\杨向军的K60模板_只有基本IO操作\src\cpu\sysinit.c
      1          /******************** (C) COPYRIGHT 2011 野火嵌入式开发工作室 ********************
      2           * 文件名       ：sysinit.c
      3           * 描述         ：k60的初始化函数
      4           * 备注         ：在官方基础上修改
      5           *
      6           * 实验平台     ：野火kinetis开发板
      7           * 库版本       ：
      8           * 嵌入系统     ：
      9           *
     10           * 作者         ：
     11           * 淘宝店       ：http://firestm32.taobao.com
     12           * 技术支持论坛 ：http://www.ourdev.cn/bbs/bbs_list.jsp?bbs_id=1008
     13          **********************************************************************************/	
     14          
     15          
     16          #include "common.h"
     17          #include "sysinit.h"
     18          #include "uart.h"
     19          
     20          
     21          /********************************************************************/
     22          
     23          /* Actual system clock frequency */

   \                                 In section .bss, align 4
     24          u32 core_clk_khz;       //内核时钟(KHz)
   \                     core_clk_khz:
   \   00000000                      DS8 4

   \                                 In section .bss, align 4
     25          u32 core_clk_mhz;       //内核时钟(MHz)
   \                     core_clk_mhz:
   \   00000000                      DS8 4

   \                                 In section .bss, align 4
     26          u32 bus_clk_khz;        //外围总线时钟
   \                     bus_clk_khz:
   \   00000000                      DS8 4
     27          
     28          
     29          
     30          /*************************************************************************
     31          *                             野火嵌入式开发工作室
     32          *
     33          *  函数名称：sysinit
     34          *  功能说明：开发板初始化函数，设置锁相环，初始化时钟 和 printf串口
     35          *  参数说明：无
     36          *  函数返回：无
     37          *  修改时间：2012-2-10
     38          *  备    注：
     39          *************************************************************************/

   \                                 In section .text, align 2, keep-with-next
     40          void sysinit (void)
     41          {
   \                     sysinit:
   \   00000000   0xB580             PUSH     {R7,LR}
     42              /* 使能所有端口PORT时钟   */
     43              SIM_SCGC5 |= (SIM_SCGC5_PORTA_MASK
     44                          | SIM_SCGC5_PORTB_MASK
     45                          | SIM_SCGC5_PORTC_MASK
     46                          | SIM_SCGC5_PORTD_MASK
     47                          | SIM_SCGC5_PORTE_MASK );
   \   00000002   0x....             LDR.N    R0,??DataTable2  ;; 0x40048038
   \   00000004   0x6800             LDR      R0,[R0, #+0]
   \   00000006   0xF450 0x5078      ORRS     R0,R0,#0x3E00
   \   0000000A   0x....             LDR.N    R1,??DataTable2  ;; 0x40048038
   \   0000000C   0x6008             STR      R0,[R1, #+0]
     48          
     49          #if defined(NO_PLL_INIT)
     50              core_clk_mhz = 20;                      //如果定义不初始化锁相环，则进入 FEI mode
     51                                                      //FEI模式下为20M P568
     52          #else
     53              /* 增强系统频率   可以在这里设置超频  */
     54              core_clk_mhz = pll_init(MCG_CLK_MHZ);
   \   0000000E   0x2060             MOVS     R0,#+96
   \   00000010   0x.... 0x....      BL       pll_init
   \   00000014   0x....             LDR.N    R1,??DataTable2_1
   \   00000016   0x6008             STR      R0,[R1, #+0]
     55          #endif
     56          
     57              //通过pll_init函数的返回值来计算内核时钟和外设时钟，便于其他函数可查询时钟频率
     58              core_clk_khz = core_clk_mhz * 1000;
   \   00000018   0x....             LDR.N    R0,??DataTable2_1
   \   0000001A   0x6800             LDR      R0,[R0, #+0]
   \   0000001C   0xF44F 0x717A      MOV      R1,#+1000
   \   00000020   0x4348             MULS     R0,R1,R0
   \   00000022   0x....             LDR.N    R1,??DataTable2_2
   \   00000024   0x6008             STR      R0,[R1, #+0]
     59              bus_clk_khz = core_clk_khz / (((SIM_CLKDIV1 & SIM_CLKDIV1_OUTDIV2_MASK) >> 24)+ 1);
   \   00000026   0x....             LDR.N    R0,??DataTable2_2
   \   00000028   0x6800             LDR      R0,[R0, #+0]
   \   0000002A   0x....             LDR.N    R1,??DataTable2_3  ;; 0x40048044
   \   0000002C   0x6809             LDR      R1,[R1, #+0]
   \   0000002E   0xF3C1 0x6103      UBFX     R1,R1,#+24,#+4
   \   00000032   0x1C49             ADDS     R1,R1,#+1
   \   00000034   0xFBB0 0xF0F1      UDIV     R0,R0,R1
   \   00000038   0x....             LDR.N    R1,??DataTable2_4
   \   0000003A   0x6008             STR      R0,[R1, #+0]
     60          
     61              //trace_clk_init();                       //使能跟踪时钟，用于调试
     62              //fb_clk_init();                          //FlexBus时钟初始化
     63          
     64              uart_init(UART_PORT, UART_BAUD);    //初始化 printf 函数所用到的串口
   \   0000003C   0xF45F 0x31E1      MOVS     R1,#+115200
   \   00000040   0x2000             MOVS     R0,#+0
   \   00000042   0x.... 0x....      BL       uart_init
     65          }
   \   00000046   0xBD01             POP      {R0,PC}          ;; return
     66          
     67          
     68          
     69          //-------------------------------------------------------------------------*
     70          //函数名: trace_clk_init                                                   *
     71          //功  能: 跟踪时钟初始化                                                   *
     72          //参  数: 无							  	   *	
     73          //返  回: 无                                                               *
     74          //说  明: 用于调试                                                         *
     75          //-------------------------------------------------------------------------*

   \                                 In section .text, align 2, keep-with-next
     76          void trace_clk_init(void)
     77          {
     78              /* Set the trace clock to the core clock frequency */
     79              SIM_SOPT2 |= SIM_SOPT2_TRACECLKSEL_MASK;
   \                     trace_clk_init:
   \   00000000   0x....             LDR.N    R0,??DataTable2_5  ;; 0x40048004
   \   00000002   0x6800             LDR      R0,[R0, #+0]
   \   00000004   0xF450 0x5080      ORRS     R0,R0,#0x1000
   \   00000008   0x....             LDR.N    R1,??DataTable2_5  ;; 0x40048004
   \   0000000A   0x6008             STR      R0,[R1, #+0]
     80          
     81              /* Enable the TRACE_CLKOUT pin function on PTA6 (alt7 function) */
     82              PORTA_PCR6 = ( PORT_PCR_MUX(0x7));
   \   0000000C   0x....             LDR.N    R0,??DataTable2_6  ;; 0x40049018
   \   0000000E   0xF44F 0x61E0      MOV      R1,#+1792
   \   00000012   0x6001             STR      R1,[R0, #+0]
     83          }
   \   00000014   0x4770             BX       LR               ;; return
     84          /********************************************************************/
     85          
     86          //-------------------------------------------------------------------------*
     87          //函数名: fb_clk_init                                                      *
     88          //功  能: FlexBus时钟初始化                                                *
     89          //参  数: 无								   *	
     90          //返  回: 无                                                               *
     91          //说  明:                                                                  *
     92          //-------------------------------------------------------------------------*

   \                                 In section .text, align 2, keep-with-next
     93          void fb_clk_init(void)
     94          {
     95              /* Enable the clock to the FlexBus module */
     96              SIM_SCGC7 |= SIM_SCGC7_FLEXBUS_MASK;
   \                     fb_clk_init:
   \   00000000   0x....             LDR.N    R0,??DataTable2_7  ;; 0x40048040
   \   00000002   0x6800             LDR      R0,[R0, #+0]
   \   00000004   0xF050 0x0001      ORRS     R0,R0,#0x1
   \   00000008   0x....             LDR.N    R1,??DataTable2_7  ;; 0x40048040
   \   0000000A   0x6008             STR      R0,[R1, #+0]
     97          
     98              /* Enable the FB_CLKOUT function on PTC3 (alt5 function) */
     99              PORTC_PCR3 = ( PORT_PCR_MUX(0x5));
   \   0000000C   0x....             LDR.N    R0,??DataTable2_8  ;; 0x4004b00c
   \   0000000E   0xF44F 0x61A0      MOV      R1,#+1280
   \   00000012   0x6001             STR      R1,[R0, #+0]
    100          }
   \   00000014   0x4770             BX       LR               ;; return

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable2:
   \   00000000   0x40048038         DC32     0x40048038

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable2_1:
   \   00000000   0x........         DC32     core_clk_mhz

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable2_2:
   \   00000000   0x........         DC32     core_clk_khz

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable2_3:
   \   00000000   0x40048044         DC32     0x40048044

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable2_4:
   \   00000000   0x........         DC32     bus_clk_khz

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable2_5:
   \   00000000   0x40048004         DC32     0x40048004

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable2_6:
   \   00000000   0x40049018         DC32     0x40049018

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable2_7:
   \   00000000   0x40048040         DC32     0x40048040

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable2_8:
   \   00000000   0x4004B00C         DC32     0x4004b00c
    101          /********************************************************************/

   Maximum stack usage in bytes:

   .cstack Function
   ------- --------
        0  fb_clk_init
        8  sysinit
             8 -> pll_init
             8 -> uart_init
        0  trace_clk_init


   Section sizes:

   Bytes  Function/Label
   -----  --------------
       4  ??DataTable2
       4  ??DataTable2_1
       4  ??DataTable2_2
       4  ??DataTable2_3
       4  ??DataTable2_4
       4  ??DataTable2_5
       4  ??DataTable2_6
       4  ??DataTable2_7
       4  ??DataTable2_8
       4  bus_clk_khz
       4  core_clk_khz
       4  core_clk_mhz
      22  fb_clk_init
      72  sysinit
      22  trace_clk_init

 
  12 bytes in section .bss
 152 bytes in section .text
 
 152 bytes of CODE memory
  12 bytes of DATA memory

Errors: none
Warnings: none
