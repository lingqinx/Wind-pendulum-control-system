###############################################################################
#                                                                             #
# IAR ANSI C/C++ Compiler V6.60.1.5097/W32 for ARM      15/Aug/2015  19:53:03 #
# Copyright 1999-2013 IAR Systems AB.                                         #
#                                                                             #
#    Cpu mode     =  thumb                                                    #
#    Endian       =  little                                                   #
#    Source file  =  C:\Users\Administrator\Desktop\MPU60508.12\src\drivers\i #
#                    2c\ioi2c.c                                               #
#    Command line =  C:\Users\Administrator\Desktop\MPU60508.12\src\drivers\i #
#                    2c\ioi2c.c -lCN C:\Users\Administrator\Desktop\MPU60508. #
#                    12\build\gpio_demo\FLASH\List\ -lB                       #
#                    C:\Users\Administrator\Desktop\MPU60508.12\build\gpio_de #
#                    mo\FLASH\List\ -o C:\Users\Administrator\Desktop\MPU6050 #
#                    8.12\build\gpio_demo\FLASH\Obj\ --no_cse --no_unroll     #
#                    --no_inline --no_code_motion --no_tbaa --no_clustering   #
#                    --no_scheduling --debug --endian=little --cpu=Cortex-M4  #
#                    -e --fpu=None --dlib_config "D:\IAR Systems\Embedded     #
#                    Workbench 6.5\arm\INC\c\DLib_Config_Normal.h" -I         #
#                    C:\Users\Administrator\Desktop\MPU60508.12\build\gpio_de #
#                    mo\..\ -I C:\Users\Administrator\Desktop\MPU60508.12\bui #
#                    ld\gpio_demo\..\..\src\common\ -I                        #
#                    C:\Users\Administrator\Desktop\MPU60508.12\build\gpio_de #
#                    mo\..\..\src\cpu\ -I C:\Users\Administrator\Desktop\MPU6 #
#                    0508.12\build\gpio_demo\..\..\src\drivers\ -I            #
#                    C:\Users\Administrator\Desktop\MPU60508.12\build\gpio_de #
#                    mo\..\..\src\drivers\gpio\ -I                            #
#                    C:\Users\Administrator\Desktop\MPU60508.12\build\gpio_de #
#                    mo\..\..\src\drivers\flash\ -I                           #
#                    C:\Users\Administrator\Desktop\MPU60508.12\build\gpio_de #
#                    mo\..\..\src\drivers\olcd\ -I                            #
#                    C:\Users\Administrator\Desktop\MPU60508.12\build\gpio_de #
#                    mo\..\..\src\drivers\diskio\ -I                          #
#                    C:\Users\Administrator\Desktop\MPU60508.12\build\gpio_de #
#                    mo\..\..\src\drivers\iospi\ -I                           #
#                    C:\Users\Administrator\Desktop\MPU60508.12\build\gpio_de #
#                    mo\..\..\src\drivers\wdog\ -I                            #
#                    C:\Users\Administrator\Desktop\MPU60508.12\build\gpio_de #
#                    mo\..\..\src\drivers\mcg\ -I                             #
#                    C:\Users\Administrator\Desktop\MPU60508.12\build\gpio_de #
#                    mo\..\..\src\drivers\flash\ -I                           #
#                    C:\Users\Administrator\Desktop\MPU60508.12\build\gpio_de #
#                    mo\..\..\src\drivers\uart\ -I                            #
#                    C:\Users\Administrator\Desktop\MPU60508.12\build\gpio_de #
#                    mo\..\..\src\drivers\lptmr\ -I                           #
#                    C:\Users\Administrator\Desktop\MPU60508.12\build\gpio_de #
#                    mo\..\..\src\drivers\LED\ -I                             #
#                    C:\Users\Administrator\Desktop\MPU60508.12\build\gpio_de #
#                    mo\..\..\src\drivers\fun\ -I                             #
#                    C:\Users\Administrator\Desktop\MPU60508.12\build\gpio_de #
#                    mo\..\..\src\drivers\FTM\ -I                             #
#                    C:\Users\Administrator\Desktop\MPU60508.12\build\gpio_de #
#                    mo\..\..\src\drivers\pit\ -I                             #
#                    C:\Users\Administrator\Desktop\MPU60508.12\build\gpio_de #
#                    mo\..\..\src\drivers\DIPswitch\ -I                       #
#                    C:\Users\Administrator\Desktop\MPU60508.12\build\gpio_de #
#                    mo\..\..\src\drivers\steer\ -I                           #
#                    C:\Users\Administrator\Desktop\MPU60508.12\build\gpio_de #
#                    mo\..\..\src\drivers\motor\ -I                           #
#                    C:\Users\Administrator\Desktop\MPU60508.12\build\gpio_de #
#                    mo\..\..\src\drivers\laser\ -I                           #
#                    C:\Users\Administrator\Desktop\MPU60508.12\build\gpio_de #
#                    mo\..\..\src\drivers\i2c\ -I                             #
#                    C:\Users\Administrator\Desktop\MPU60508.12\build\gpio_de #
#                    mo\..\..\src\drivers\ADdevice\ -I                        #
#                    C:\Users\Administrator\Desktop\MPU60508.12\build\gpio_de #
#                    mo\..\..\src\drivers\adc\ -I                             #
#                    C:\Users\Administrator\Desktop\MPU60508.12\build\gpio_de #
#                    mo\..\..\src\drivers\serial_digtal_scope\ -I             #
#                    C:\Users\Administrator\Desktop\MPU60508.12\build\gpio_de #
#                    mo\..\..\src\drivers\MMA845x\ -I                         #
#                    C:\Users\Administrator\Desktop\MPU60508.12\build\gpio_de #
#                    mo\..\..\src\drivers\exti\ -I                            #
#                    C:\Users\Administrator\Desktop\MPU60508.12\build\gpio_de #
#                    mo\..\..\src\drivers\dma\ -I                             #
#                    C:\Users\Administrator\Desktop\MPU60508.12\build\gpio_de #
#                    mo\..\..\src\platforms\ -I C:\Users\Administrator\Deskto #
#                    p\MPU60508.12\build\gpio_demo\..\..\src\projects\ -I     #
#                    C:\Users\Administrator\Desktop\MPU60508.12\build\gpio_de #
#                    mo\..\..\src\projects\gpio_demo\ -I                      #
#                    C:\Users\Administrator\Desktop\MPU60508.12\build\gpio_de #
#                    mo\..\..\src\drivers\MPU6050\ -I                         #
#                    C:\Users\Administrator\Desktop\MPU60508.12\build\gpio_de #
#                    mo\..\..\src\drivers\steer\ -Ol                          #
#    List file    =  C:\Users\Administrator\Desktop\MPU60508.12\build\gpio_de #
#                    mo\FLASH\List\ioi2c.lst                                  #
#    Object file  =  C:\Users\Administrator\Desktop\MPU60508.12\build\gpio_de #
#                    mo\FLASH\Obj\ioi2c.o                                     #
#                                                                             #
#                                                                             #
###############################################################################

C:\Users\Administrator\Desktop\MPU60508.12\src\drivers\i2c\ioi2c.c
      1          /*
      2          ************************************************************************
      3          *                飞思卡尔智能车程序  直立行走例程                                       
      4          * 文件名 :[ioi2c.c] 
      5          * 描  述 ：模拟IIC
      6          * 设  计 ：snowwolf
      7          *  Email ：snowwolf2012@qq.com
      8          * 说  明 ：
      9          ***********************************************************************
     10          */
     11          
     12          
     13          
     14          #include "ioi2c.h"
     15          
     16          #ifdef IOIIC
     17          
     18          //内部数据定义

   \                                 In section .bss, align 1
     19          unsigned char IIC_ad_main; //器件从地址	    
   \                     IIC_ad_main:
   \   00000000                      DS8 1

   \                                 In section .bss, align 1
     20          unsigned char IIC_ad_sub;  //器件子地址	   
   \                     IIC_ad_sub:
   \   00000000                      DS8 1

   \                                 In section .bss, align 4
     21          unsigned char *IIC_buf;    //发送|接收数据缓冲区	    
   \                     IIC_buf:
   \   00000000                      DS8 4

   \                                 In section .bss, align 1
     22          unsigned char IIC_num;     //发送|接收数据个数	
   \                     IIC_num:
   \   00000000                      DS8 1
     23          
     24          

   \                                 In section .text, align 4, keep-with-next
     25           void IIC_start(void)
     26           {
     27          	SCL=0;
   \                     IIC_start: (+1)
   \   00000000   0x.... 0x....      LDR.W    R0,??DataTable4  ;; 0x400ff040
   \   00000004   0x6800             LDR      R0,[R0, #+0]
   \   00000006   0x0840             LSRS     R0,R0,#+1
   \   00000008   0x0040             LSLS     R0,R0,#+1
   \   0000000A   0x.... 0x....      LDR.W    R1,??DataTable4  ;; 0x400ff040
   \   0000000E   0x6008             STR      R0,[R1, #+0]
     28          	SDA=1;
   \   00000010   0x.... 0x....      LDR.W    R0,??DataTable4  ;; 0x400ff040
   \   00000014   0x6800             LDR      R0,[R0, #+0]
   \   00000016   0xF050 0x0002      ORRS     R0,R0,#0x2
   \   0000001A   0x.... 0x....      LDR.W    R1,??DataTable4  ;; 0x400ff040
   \   0000001E   0x6008             STR      R0,[R1, #+0]
     29          	ioi2cnops();
   \   00000020   0xBF00             nop
   \   00000022   0xBF00             nop
   \   00000024   0xBF00             nop
   \   00000026   0xBF00             nop
   \   00000028   0xBF00             nop
   \   0000002A   0xBF00             nop
   \   0000002C   0xBF00             nop
   \   0000002E   0xBF00             nop
   \   00000030   0xBF00             nop
   \   00000032   0xBF00             nop
   \   00000034   0xBF00             nop
   \   00000036   0xBF00             nop
   \   00000038   0xBF00             nop
   \   0000003A   0xBF00             nop
   \   0000003C   0xBF00             nop
   \   0000003E   0xBF00             nop
   \   00000040   0xBF00             nop
   \   00000042   0xBF00             nop
   \   00000044   0xBF00             nop
   \   00000046   0xBF00             nop
   \   00000048   0xBF00             nop
   \   0000004A   0xBF00             nop
   \   0000004C   0xBF00             nop
   \   0000004E   0xBF00             nop
   \   00000050   0xBF00             nop
   \   00000052   0xBF00             nop
   \   00000054   0xBF00             nop
   \   00000056   0xBF00             nop
   \   00000058   0xBF00             nop
   \   0000005A   0xBF00             nop
   \   0000005C   0xBF00             nop
   \   0000005E   0xBF00             nop
   \   00000060   0xBF00             nop
   \   00000062   0xBF00             nop
   \   00000064   0xBF00             nop
   \   00000066   0xBF00             nop
   \   00000068   0xBF00             nop
   \   0000006A   0xBF00             nop
   \   0000006C   0xBF00             nop
   \   0000006E   0xBF00             nop
   \   00000070   0xBF00             nop
   \   00000072   0xBF00             nop
   \   00000074   0xBF00             nop
   \   00000076   0xBF00             nop
   \   00000078   0xBF00             nop
   \   0000007A   0xBF00             nop
   \   0000007C   0xBF00             nop
   \   0000007E   0xBF00             nop
   \   00000080   0xBF00             nop
   \   00000082   0xBF00             nop
     30          	SCL=1;
   \   00000084   0x.... 0x....      LDR.W    R0,??DataTable4  ;; 0x400ff040
   \   00000088   0x6800             LDR      R0,[R0, #+0]
   \   0000008A   0xF050 0x0001      ORRS     R0,R0,#0x1
   \   0000008E   0x.... 0x....      LDR.W    R1,??DataTable4  ;; 0x400ff040
   \   00000092   0x6008             STR      R0,[R1, #+0]
     31          	ioi2cnops();
   \   00000094   0xBF00             nop
   \   00000096   0xBF00             nop
   \   00000098   0xBF00             nop
   \   0000009A   0xBF00             nop
   \   0000009C   0xBF00             nop
   \   0000009E   0xBF00             nop
   \   000000A0   0xBF00             nop
   \   000000A2   0xBF00             nop
   \   000000A4   0xBF00             nop
   \   000000A6   0xBF00             nop
   \   000000A8   0xBF00             nop
   \   000000AA   0xBF00             nop
   \   000000AC   0xBF00             nop
   \   000000AE   0xBF00             nop
   \   000000B0   0xBF00             nop
   \   000000B2   0xBF00             nop
   \   000000B4   0xBF00             nop
   \   000000B6   0xBF00             nop
   \   000000B8   0xBF00             nop
   \   000000BA   0xBF00             nop
   \   000000BC   0xBF00             nop
   \   000000BE   0xBF00             nop
   \   000000C0   0xBF00             nop
   \   000000C2   0xBF00             nop
   \   000000C4   0xBF00             nop
   \   000000C6   0xBF00             nop
   \   000000C8   0xBF00             nop
   \   000000CA   0xBF00             nop
   \   000000CC   0xBF00             nop
   \   000000CE   0xBF00             nop
   \   000000D0   0xBF00             nop
   \   000000D2   0xBF00             nop
   \   000000D4   0xBF00             nop
   \   000000D6   0xBF00             nop
   \   000000D8   0xBF00             nop
   \   000000DA   0xBF00             nop
   \   000000DC   0xBF00             nop
   \   000000DE   0xBF00             nop
   \   000000E0   0xBF00             nop
   \   000000E2   0xBF00             nop
   \   000000E4   0xBF00             nop
   \   000000E6   0xBF00             nop
   \   000000E8   0xBF00             nop
   \   000000EA   0xBF00             nop
   \   000000EC   0xBF00             nop
   \   000000EE   0xBF00             nop
   \   000000F0   0xBF00             nop
   \   000000F2   0xBF00             nop
   \   000000F4   0xBF00             nop
   \   000000F6   0xBF00             nop
     32          	SDA=0;
   \   000000F8   0x.... 0x....      LDR.W    R0,??DataTable4  ;; 0x400ff040
   \   000000FC   0x6800             LDR      R0,[R0, #+0]
   \   000000FE   0xF030 0x0002      BICS     R0,R0,#0x2
   \   00000102   0x.... 0x....      LDR.W    R1,??DataTable4  ;; 0x400ff040
   \   00000106   0x6008             STR      R0,[R1, #+0]
     33          	ioi2cnops();
   \   00000108   0xBF00             nop
   \   0000010A   0xBF00             nop
   \   0000010C   0xBF00             nop
   \   0000010E   0xBF00             nop
   \   00000110   0xBF00             nop
   \   00000112   0xBF00             nop
   \   00000114   0xBF00             nop
   \   00000116   0xBF00             nop
   \   00000118   0xBF00             nop
   \   0000011A   0xBF00             nop
   \   0000011C   0xBF00             nop
   \   0000011E   0xBF00             nop
   \   00000120   0xBF00             nop
   \   00000122   0xBF00             nop
   \   00000124   0xBF00             nop
   \   00000126   0xBF00             nop
   \   00000128   0xBF00             nop
   \   0000012A   0xBF00             nop
   \   0000012C   0xBF00             nop
   \   0000012E   0xBF00             nop
   \   00000130   0xBF00             nop
   \   00000132   0xBF00             nop
   \   00000134   0xBF00             nop
   \   00000136   0xBF00             nop
   \   00000138   0xBF00             nop
   \   0000013A   0xBF00             nop
   \   0000013C   0xBF00             nop
   \   0000013E   0xBF00             nop
   \   00000140   0xBF00             nop
   \   00000142   0xBF00             nop
   \   00000144   0xBF00             nop
   \   00000146   0xBF00             nop
   \   00000148   0xBF00             nop
   \   0000014A   0xBF00             nop
   \   0000014C   0xBF00             nop
   \   0000014E   0xBF00             nop
   \   00000150   0xBF00             nop
   \   00000152   0xBF00             nop
   \   00000154   0xBF00             nop
   \   00000156   0xBF00             nop
   \   00000158   0xBF00             nop
   \   0000015A   0xBF00             nop
   \   0000015C   0xBF00             nop
   \   0000015E   0xBF00             nop
   \   00000160   0xBF00             nop
   \   00000162   0xBF00             nop
   \   00000164   0xBF00             nop
   \   00000166   0xBF00             nop
   \   00000168   0xBF00             nop
   \   0000016A   0xBF00             nop
     34          	SCL=0;
   \   0000016C   0x.... 0x....      LDR.W    R0,??DataTable4  ;; 0x400ff040
   \   00000170   0x6800             LDR      R0,[R0, #+0]
   \   00000172   0x0840             LSRS     R0,R0,#+1
   \   00000174   0x0040             LSLS     R0,R0,#+1
   \   00000176   0x.... 0x....      LDR.W    R1,??DataTable4  ;; 0x400ff040
   \   0000017A   0x6008             STR      R0,[R1, #+0]
     35          }
   \   0000017C   0x4770             BX       LR               ;; return
     36          //************************************************
     37          //送停止位 SDA=0->1

   \                                 In section .text, align 4, keep-with-next
     38          void IIC_stop(void)
     39          {
     40          	SCL=0;
   \                     IIC_stop: (+1)
   \   00000000   0x.... 0x....      LDR.W    R0,??DataTable4  ;; 0x400ff040
   \   00000004   0x6800             LDR      R0,[R0, #+0]
   \   00000006   0x0840             LSRS     R0,R0,#+1
   \   00000008   0x0040             LSLS     R0,R0,#+1
   \   0000000A   0x.... 0x....      LDR.W    R1,??DataTable4  ;; 0x400ff040
   \   0000000E   0x6008             STR      R0,[R1, #+0]
     41          	ioi2cnops();
   \   00000010   0xBF00             nop
   \   00000012   0xBF00             nop
   \   00000014   0xBF00             nop
   \   00000016   0xBF00             nop
   \   00000018   0xBF00             nop
   \   0000001A   0xBF00             nop
   \   0000001C   0xBF00             nop
   \   0000001E   0xBF00             nop
   \   00000020   0xBF00             nop
   \   00000022   0xBF00             nop
   \   00000024   0xBF00             nop
   \   00000026   0xBF00             nop
   \   00000028   0xBF00             nop
   \   0000002A   0xBF00             nop
   \   0000002C   0xBF00             nop
   \   0000002E   0xBF00             nop
   \   00000030   0xBF00             nop
   \   00000032   0xBF00             nop
   \   00000034   0xBF00             nop
   \   00000036   0xBF00             nop
   \   00000038   0xBF00             nop
   \   0000003A   0xBF00             nop
   \   0000003C   0xBF00             nop
   \   0000003E   0xBF00             nop
   \   00000040   0xBF00             nop
   \   00000042   0xBF00             nop
   \   00000044   0xBF00             nop
   \   00000046   0xBF00             nop
   \   00000048   0xBF00             nop
   \   0000004A   0xBF00             nop
   \   0000004C   0xBF00             nop
   \   0000004E   0xBF00             nop
   \   00000050   0xBF00             nop
   \   00000052   0xBF00             nop
   \   00000054   0xBF00             nop
   \   00000056   0xBF00             nop
   \   00000058   0xBF00             nop
   \   0000005A   0xBF00             nop
   \   0000005C   0xBF00             nop
   \   0000005E   0xBF00             nop
   \   00000060   0xBF00             nop
   \   00000062   0xBF00             nop
   \   00000064   0xBF00             nop
   \   00000066   0xBF00             nop
   \   00000068   0xBF00             nop
   \   0000006A   0xBF00             nop
   \   0000006C   0xBF00             nop
   \   0000006E   0xBF00             nop
   \   00000070   0xBF00             nop
   \   00000072   0xBF00             nop
     42          	SDA=0;
   \   00000074   0x.... 0x....      LDR.W    R0,??DataTable4  ;; 0x400ff040
   \   00000078   0x6800             LDR      R0,[R0, #+0]
   \   0000007A   0xF030 0x0002      BICS     R0,R0,#0x2
   \   0000007E   0x.... 0x....      LDR.W    R1,??DataTable4  ;; 0x400ff040
   \   00000082   0x6008             STR      R0,[R1, #+0]
     43          	ioi2cnops();
   \   00000084   0xBF00             nop
   \   00000086   0xBF00             nop
   \   00000088   0xBF00             nop
   \   0000008A   0xBF00             nop
   \   0000008C   0xBF00             nop
   \   0000008E   0xBF00             nop
   \   00000090   0xBF00             nop
   \   00000092   0xBF00             nop
   \   00000094   0xBF00             nop
   \   00000096   0xBF00             nop
   \   00000098   0xBF00             nop
   \   0000009A   0xBF00             nop
   \   0000009C   0xBF00             nop
   \   0000009E   0xBF00             nop
   \   000000A0   0xBF00             nop
   \   000000A2   0xBF00             nop
   \   000000A4   0xBF00             nop
   \   000000A6   0xBF00             nop
   \   000000A8   0xBF00             nop
   \   000000AA   0xBF00             nop
   \   000000AC   0xBF00             nop
   \   000000AE   0xBF00             nop
   \   000000B0   0xBF00             nop
   \   000000B2   0xBF00             nop
   \   000000B4   0xBF00             nop
   \   000000B6   0xBF00             nop
   \   000000B8   0xBF00             nop
   \   000000BA   0xBF00             nop
   \   000000BC   0xBF00             nop
   \   000000BE   0xBF00             nop
   \   000000C0   0xBF00             nop
   \   000000C2   0xBF00             nop
   \   000000C4   0xBF00             nop
   \   000000C6   0xBF00             nop
   \   000000C8   0xBF00             nop
   \   000000CA   0xBF00             nop
   \   000000CC   0xBF00             nop
   \   000000CE   0xBF00             nop
   \   000000D0   0xBF00             nop
   \   000000D2   0xBF00             nop
   \   000000D4   0xBF00             nop
   \   000000D6   0xBF00             nop
   \   000000D8   0xBF00             nop
   \   000000DA   0xBF00             nop
   \   000000DC   0xBF00             nop
   \   000000DE   0xBF00             nop
   \   000000E0   0xBF00             nop
   \   000000E2   0xBF00             nop
   \   000000E4   0xBF00             nop
   \   000000E6   0xBF00             nop
     44          	SCL=1;
   \   000000E8   0x.... 0x....      LDR.W    R0,??DataTable4  ;; 0x400ff040
   \   000000EC   0x6800             LDR      R0,[R0, #+0]
   \   000000EE   0xF050 0x0001      ORRS     R0,R0,#0x1
   \   000000F2   0x.... 0x....      LDR.W    R1,??DataTable4  ;; 0x400ff040
   \   000000F6   0x6008             STR      R0,[R1, #+0]
     45          	ioi2cnops();
   \   000000F8   0xBF00             nop
   \   000000FA   0xBF00             nop
   \   000000FC   0xBF00             nop
   \   000000FE   0xBF00             nop
   \   00000100   0xBF00             nop
   \   00000102   0xBF00             nop
   \   00000104   0xBF00             nop
   \   00000106   0xBF00             nop
   \   00000108   0xBF00             nop
   \   0000010A   0xBF00             nop
   \   0000010C   0xBF00             nop
   \   0000010E   0xBF00             nop
   \   00000110   0xBF00             nop
   \   00000112   0xBF00             nop
   \   00000114   0xBF00             nop
   \   00000116   0xBF00             nop
   \   00000118   0xBF00             nop
   \   0000011A   0xBF00             nop
   \   0000011C   0xBF00             nop
   \   0000011E   0xBF00             nop
   \   00000120   0xBF00             nop
   \   00000122   0xBF00             nop
   \   00000124   0xBF00             nop
   \   00000126   0xBF00             nop
   \   00000128   0xBF00             nop
   \   0000012A   0xBF00             nop
   \   0000012C   0xBF00             nop
   \   0000012E   0xBF00             nop
   \   00000130   0xBF00             nop
   \   00000132   0xBF00             nop
   \   00000134   0xBF00             nop
   \   00000136   0xBF00             nop
   \   00000138   0xBF00             nop
   \   0000013A   0xBF00             nop
   \   0000013C   0xBF00             nop
   \   0000013E   0xBF00             nop
   \   00000140   0xBF00             nop
   \   00000142   0xBF00             nop
   \   00000144   0xBF00             nop
   \   00000146   0xBF00             nop
   \   00000148   0xBF00             nop
   \   0000014A   0xBF00             nop
   \   0000014C   0xBF00             nop
   \   0000014E   0xBF00             nop
   \   00000150   0xBF00             nop
   \   00000152   0xBF00             nop
   \   00000154   0xBF00             nop
   \   00000156   0xBF00             nop
   \   00000158   0xBF00             nop
   \   0000015A   0xBF00             nop
     46          	SDA=1;
   \   0000015C   0x.... 0x....      LDR.W    R0,??DataTable4  ;; 0x400ff040
   \   00000160   0x6800             LDR      R0,[R0, #+0]
   \   00000162   0xF050 0x0002      ORRS     R0,R0,#0x2
   \   00000166   0x.... 0x....      LDR.W    R1,??DataTable4  ;; 0x400ff040
   \   0000016A   0x6008             STR      R0,[R1, #+0]
     47          	ioi2cnops();
   \   0000016C   0xBF00             nop
   \   0000016E   0xBF00             nop
   \   00000170   0xBF00             nop
   \   00000172   0xBF00             nop
   \   00000174   0xBF00             nop
   \   00000176   0xBF00             nop
   \   00000178   0xBF00             nop
   \   0000017A   0xBF00             nop
   \   0000017C   0xBF00             nop
   \   0000017E   0xBF00             nop
   \   00000180   0xBF00             nop
   \   00000182   0xBF00             nop
   \   00000184   0xBF00             nop
   \   00000186   0xBF00             nop
   \   00000188   0xBF00             nop
   \   0000018A   0xBF00             nop
   \   0000018C   0xBF00             nop
   \   0000018E   0xBF00             nop
   \   00000190   0xBF00             nop
   \   00000192   0xBF00             nop
   \   00000194   0xBF00             nop
   \   00000196   0xBF00             nop
   \   00000198   0xBF00             nop
   \   0000019A   0xBF00             nop
   \   0000019C   0xBF00             nop
   \   0000019E   0xBF00             nop
   \   000001A0   0xBF00             nop
   \   000001A2   0xBF00             nop
   \   000001A4   0xBF00             nop
   \   000001A6   0xBF00             nop
   \   000001A8   0xBF00             nop
   \   000001AA   0xBF00             nop
   \   000001AC   0xBF00             nop
   \   000001AE   0xBF00             nop
   \   000001B0   0xBF00             nop
   \   000001B2   0xBF00             nop
   \   000001B4   0xBF00             nop
   \   000001B6   0xBF00             nop
   \   000001B8   0xBF00             nop
   \   000001BA   0xBF00             nop
   \   000001BC   0xBF00             nop
   \   000001BE   0xBF00             nop
   \   000001C0   0xBF00             nop
   \   000001C2   0xBF00             nop
   \   000001C4   0xBF00             nop
   \   000001C6   0xBF00             nop
   \   000001C8   0xBF00             nop
   \   000001CA   0xBF00             nop
   \   000001CC   0xBF00             nop
   \   000001CE   0xBF00             nop
     48          	SCL=0;
   \   000001D0   0x.... 0x....      LDR.W    R0,??DataTable4  ;; 0x400ff040
   \   000001D4   0x6800             LDR      R0,[R0, #+0]
   \   000001D6   0x0840             LSRS     R0,R0,#+1
   \   000001D8   0x0040             LSLS     R0,R0,#+1
   \   000001DA   0x.... 0x....      LDR.W    R1,??DataTable4  ;; 0x400ff040
   \   000001DE   0x6008             STR      R0,[R1, #+0]
     49          }
   \   000001E0   0x4770             BX       LR               ;; return
     50          //************************************************
     51          //主应答(包含ack:SDA=0和no_ack:SDA=0)

   \                                 In section .text, align 4, keep-with-next
     52          void IIC_ack_main(byte ack_main){
     53          	SCL=0;
   \                     IIC_ack_main: (+1)
   \   00000000   0x.... 0x....      LDR.W    R1,??DataTable4  ;; 0x400ff040
   \   00000004   0x6809             LDR      R1,[R1, #+0]
   \   00000006   0x0849             LSRS     R1,R1,#+1
   \   00000008   0x0049             LSLS     R1,R1,#+1
   \   0000000A   0x.... 0x....      LDR.W    R2,??DataTable4  ;; 0x400ff040
   \   0000000E   0x6011             STR      R1,[R2, #+0]
     54          	if(ack_main)SDA=0; //ack主应答
   \   00000010   0xB2C0             UXTB     R0,R0            ;; ZeroExt  R0,R0,#+24,#+24
   \   00000012   0x2800             CMP      R0,#+0
   \   00000014   0xD008             BEQ.N    ??IIC_ack_main_0
   \   00000016   0x.... 0x....      LDR.W    R0,??DataTable4  ;; 0x400ff040
   \   0000001A   0x6800             LDR      R0,[R0, #+0]
   \   0000001C   0xF030 0x0002      BICS     R0,R0,#0x2
   \   00000020   0x.... 0x....      LDR.W    R1,??DataTable4  ;; 0x400ff040
   \   00000024   0x6008             STR      R0,[R1, #+0]
   \   00000026   0xE007             B.N      ??IIC_ack_main_1
     55          	else SDA=1; //no_ack无需应答
   \                     ??IIC_ack_main_0: (+1)
   \   00000028   0x.... 0x....      LDR.W    R0,??DataTable4  ;; 0x400ff040
   \   0000002C   0x6800             LDR      R0,[R0, #+0]
   \   0000002E   0xF050 0x0002      ORRS     R0,R0,#0x2
   \   00000032   0x.... 0x....      LDR.W    R1,??DataTable4  ;; 0x400ff040
   \   00000036   0x6008             STR      R0,[R1, #+0]
     56          	ioi2cnops();
   \                     ??IIC_ack_main_1: (+1)
   \   00000038   0xBF00             nop
   \   0000003A   0xBF00             nop
   \   0000003C   0xBF00             nop
   \   0000003E   0xBF00             nop
   \   00000040   0xBF00             nop
   \   00000042   0xBF00             nop
   \   00000044   0xBF00             nop
   \   00000046   0xBF00             nop
   \   00000048   0xBF00             nop
   \   0000004A   0xBF00             nop
   \   0000004C   0xBF00             nop
   \   0000004E   0xBF00             nop
   \   00000050   0xBF00             nop
   \   00000052   0xBF00             nop
   \   00000054   0xBF00             nop
   \   00000056   0xBF00             nop
   \   00000058   0xBF00             nop
   \   0000005A   0xBF00             nop
   \   0000005C   0xBF00             nop
   \   0000005E   0xBF00             nop
   \   00000060   0xBF00             nop
   \   00000062   0xBF00             nop
   \   00000064   0xBF00             nop
   \   00000066   0xBF00             nop
   \   00000068   0xBF00             nop
   \   0000006A   0xBF00             nop
   \   0000006C   0xBF00             nop
   \   0000006E   0xBF00             nop
   \   00000070   0xBF00             nop
   \   00000072   0xBF00             nop
   \   00000074   0xBF00             nop
   \   00000076   0xBF00             nop
   \   00000078   0xBF00             nop
   \   0000007A   0xBF00             nop
   \   0000007C   0xBF00             nop
   \   0000007E   0xBF00             nop
   \   00000080   0xBF00             nop
   \   00000082   0xBF00             nop
   \   00000084   0xBF00             nop
   \   00000086   0xBF00             nop
   \   00000088   0xBF00             nop
   \   0000008A   0xBF00             nop
   \   0000008C   0xBF00             nop
   \   0000008E   0xBF00             nop
   \   00000090   0xBF00             nop
   \   00000092   0xBF00             nop
   \   00000094   0xBF00             nop
   \   00000096   0xBF00             nop
   \   00000098   0xBF00             nop
   \   0000009A   0xBF00             nop
     57          	SCL=1;
   \   0000009C   0x.... 0x....      LDR.W    R0,??DataTable4  ;; 0x400ff040
   \   000000A0   0x6800             LDR      R0,[R0, #+0]
   \   000000A2   0xF050 0x0001      ORRS     R0,R0,#0x1
   \   000000A6   0x.... 0x....      LDR.W    R1,??DataTable4  ;; 0x400ff040
   \   000000AA   0x6008             STR      R0,[R1, #+0]
     58          	ioi2cnops();
   \   000000AC   0xBF00             nop
   \   000000AE   0xBF00             nop
   \   000000B0   0xBF00             nop
   \   000000B2   0xBF00             nop
   \   000000B4   0xBF00             nop
   \   000000B6   0xBF00             nop
   \   000000B8   0xBF00             nop
   \   000000BA   0xBF00             nop
   \   000000BC   0xBF00             nop
   \   000000BE   0xBF00             nop
   \   000000C0   0xBF00             nop
   \   000000C2   0xBF00             nop
   \   000000C4   0xBF00             nop
   \   000000C6   0xBF00             nop
   \   000000C8   0xBF00             nop
   \   000000CA   0xBF00             nop
   \   000000CC   0xBF00             nop
   \   000000CE   0xBF00             nop
   \   000000D0   0xBF00             nop
   \   000000D2   0xBF00             nop
   \   000000D4   0xBF00             nop
   \   000000D6   0xBF00             nop
   \   000000D8   0xBF00             nop
   \   000000DA   0xBF00             nop
   \   000000DC   0xBF00             nop
   \   000000DE   0xBF00             nop
   \   000000E0   0xBF00             nop
   \   000000E2   0xBF00             nop
   \   000000E4   0xBF00             nop
   \   000000E6   0xBF00             nop
   \   000000E8   0xBF00             nop
   \   000000EA   0xBF00             nop
   \   000000EC   0xBF00             nop
   \   000000EE   0xBF00             nop
   \   000000F0   0xBF00             nop
   \   000000F2   0xBF00             nop
   \   000000F4   0xBF00             nop
   \   000000F6   0xBF00             nop
   \   000000F8   0xBF00             nop
   \   000000FA   0xBF00             nop
   \   000000FC   0xBF00             nop
   \   000000FE   0xBF00             nop
   \   00000100   0xBF00             nop
   \   00000102   0xBF00             nop
   \   00000104   0xBF00             nop
   \   00000106   0xBF00             nop
   \   00000108   0xBF00             nop
   \   0000010A   0xBF00             nop
   \   0000010C   0xBF00             nop
   \   0000010E   0xBF00             nop
     59          	SCL=0;
   \   00000110   0x.... 0x....      LDR.W    R0,??DataTable4  ;; 0x400ff040
   \   00000114   0x6800             LDR      R0,[R0, #+0]
   \   00000116   0x0840             LSRS     R0,R0,#+1
   \   00000118   0x0040             LSLS     R0,R0,#+1
   \   0000011A   0x.... 0x....      LDR.W    R1,??DataTable4  ;; 0x400ff040
   \   0000011E   0x6008             STR      R0,[R1, #+0]
     60          }
   \   00000120   0x4770             BX       LR               ;; return
     61          //*************************************************
     62          //字节发送程序
     63          //发送c(可以是数据也可是地址)，送完后接收从应答
     64          //不考虑从应答位
     65          

   \                                 In section .text, align 4, keep-with-next
     66          void send_byte(unsigned char c){
     67          	unsigned char i;
     68           //unsigned char ack; //因为没有看到他的用途，所以就注释掉了，下面也一样
     69          	for(i=0;i<8;i++)
   \                     send_byte: (+1)
   \   00000000   0x2100             MOVS     R1,#+0
   \   00000002   0xE07C             B.N      ??send_byte_0
     70                  {
     71                      SCL=0;
     72                      if((c<<i) & 0x80)SDA=1; //判断发送位
     73                      else SDA=0;
   \                     ??send_byte_1: (+1)
   \   00000004   0x.... 0x....      LDR.W    R2,??DataTable4  ;; 0x400ff040
   \   00000008   0x6812             LDR      R2,[R2, #+0]
   \   0000000A   0xF032 0x0202      BICS     R2,R2,#0x2
   \   0000000E   0x.... 0x....      LDR.W    R3,??DataTable4  ;; 0x400ff040
   \   00000012   0x601A             STR      R2,[R3, #+0]
     74                      ioi2cnops();
   \                     ??send_byte_2: (+1)
   \   00000014   0xBF00             nop
   \   00000016   0xBF00             nop
   \   00000018   0xBF00             nop
   \   0000001A   0xBF00             nop
   \   0000001C   0xBF00             nop
   \   0000001E   0xBF00             nop
   \   00000020   0xBF00             nop
   \   00000022   0xBF00             nop
   \   00000024   0xBF00             nop
   \   00000026   0xBF00             nop
   \   00000028   0xBF00             nop
   \   0000002A   0xBF00             nop
   \   0000002C   0xBF00             nop
   \   0000002E   0xBF00             nop
   \   00000030   0xBF00             nop
   \   00000032   0xBF00             nop
   \   00000034   0xBF00             nop
   \   00000036   0xBF00             nop
   \   00000038   0xBF00             nop
   \   0000003A   0xBF00             nop
   \   0000003C   0xBF00             nop
   \   0000003E   0xBF00             nop
   \   00000040   0xBF00             nop
   \   00000042   0xBF00             nop
   \   00000044   0xBF00             nop
   \   00000046   0xBF00             nop
   \   00000048   0xBF00             nop
   \   0000004A   0xBF00             nop
   \   0000004C   0xBF00             nop
   \   0000004E   0xBF00             nop
   \   00000050   0xBF00             nop
   \   00000052   0xBF00             nop
   \   00000054   0xBF00             nop
   \   00000056   0xBF00             nop
   \   00000058   0xBF00             nop
   \   0000005A   0xBF00             nop
   \   0000005C   0xBF00             nop
   \   0000005E   0xBF00             nop
   \   00000060   0xBF00             nop
   \   00000062   0xBF00             nop
   \   00000064   0xBF00             nop
   \   00000066   0xBF00             nop
   \   00000068   0xBF00             nop
   \   0000006A   0xBF00             nop
   \   0000006C   0xBF00             nop
   \   0000006E   0xBF00             nop
   \   00000070   0xBF00             nop
   \   00000072   0xBF00             nop
   \   00000074   0xBF00             nop
   \   00000076   0xBF00             nop
     75                      SCL=1;
   \   00000078   0x.... 0x....      LDR.W    R2,??DataTable4  ;; 0x400ff040
   \   0000007C   0x6812             LDR      R2,[R2, #+0]
   \   0000007E   0xF052 0x0201      ORRS     R2,R2,#0x1
   \   00000082   0x.... 0x....      LDR.W    R3,??DataTable4  ;; 0x400ff040
   \   00000086   0x601A             STR      R2,[R3, #+0]
     76                      ioi2cnops();
   \   00000088   0xBF00             nop
   \   0000008A   0xBF00             nop
   \   0000008C   0xBF00             nop
   \   0000008E   0xBF00             nop
   \   00000090   0xBF00             nop
   \   00000092   0xBF00             nop
   \   00000094   0xBF00             nop
   \   00000096   0xBF00             nop
   \   00000098   0xBF00             nop
   \   0000009A   0xBF00             nop
   \   0000009C   0xBF00             nop
   \   0000009E   0xBF00             nop
   \   000000A0   0xBF00             nop
   \   000000A2   0xBF00             nop
   \   000000A4   0xBF00             nop
   \   000000A6   0xBF00             nop
   \   000000A8   0xBF00             nop
   \   000000AA   0xBF00             nop
   \   000000AC   0xBF00             nop
   \   000000AE   0xBF00             nop
   \   000000B0   0xBF00             nop
   \   000000B2   0xBF00             nop
   \   000000B4   0xBF00             nop
   \   000000B6   0xBF00             nop
   \   000000B8   0xBF00             nop
   \   000000BA   0xBF00             nop
   \   000000BC   0xBF00             nop
   \   000000BE   0xBF00             nop
   \   000000C0   0xBF00             nop
   \   000000C2   0xBF00             nop
   \   000000C4   0xBF00             nop
   \   000000C6   0xBF00             nop
   \   000000C8   0xBF00             nop
   \   000000CA   0xBF00             nop
   \   000000CC   0xBF00             nop
   \   000000CE   0xBF00             nop
   \   000000D0   0xBF00             nop
   \   000000D2   0xBF00             nop
   \   000000D4   0xBF00             nop
   \   000000D6   0xBF00             nop
   \   000000D8   0xBF00             nop
   \   000000DA   0xBF00             nop
   \   000000DC   0xBF00             nop
   \   000000DE   0xBF00             nop
   \   000000E0   0xBF00             nop
   \   000000E2   0xBF00             nop
   \   000000E4   0xBF00             nop
   \   000000E6   0xBF00             nop
   \   000000E8   0xBF00             nop
   \   000000EA   0xBF00             nop
     77                      SCL=0;
   \   000000EC   0x.... 0x....      LDR.W    R2,??DataTable4  ;; 0x400ff040
   \   000000F0   0x6812             LDR      R2,[R2, #+0]
   \   000000F2   0x0852             LSRS     R2,R2,#+1
   \   000000F4   0x0052             LSLS     R2,R2,#+1
   \   000000F6   0x.... 0x....      LDR.W    R3,??DataTable4  ;; 0x400ff040
   \   000000FA   0x601A             STR      R2,[R3, #+0]
   \   000000FC   0x1C49             ADDS     R1,R1,#+1
   \                     ??send_byte_0: (+1)
   \   000000FE   0xB2C9             UXTB     R1,R1            ;; ZeroExt  R1,R1,#+24,#+24
   \   00000100   0x2908             CMP      R1,#+8
   \   00000102   0xDA16             BGE.N    ??send_byte_3
   \   00000104   0x.... 0x....      LDR.W    R2,??DataTable4  ;; 0x400ff040
   \   00000108   0x6812             LDR      R2,[R2, #+0]
   \   0000010A   0x0852             LSRS     R2,R2,#+1
   \   0000010C   0x0052             LSLS     R2,R2,#+1
   \   0000010E   0x.... 0x....      LDR.W    R3,??DataTable4  ;; 0x400ff040
   \   00000112   0x601A             STR      R2,[R3, #+0]
   \   00000114   0xB2C0             UXTB     R0,R0            ;; ZeroExt  R0,R0,#+24,#+24
   \   00000116   0xFA10 0xF201      LSLS     R2,R0,R1
   \   0000011A   0x0612             LSLS     R2,R2,#+24
   \   0000011C   0xF57F 0xAF72      BPL.W    ??send_byte_1
   \   00000120   0x.... 0x....      LDR.W    R2,??DataTable4  ;; 0x400ff040
   \   00000124   0x6812             LDR      R2,[R2, #+0]
   \   00000126   0xF052 0x0202      ORRS     R2,R2,#0x2
   \   0000012A   0x.... 0x....      LDR.W    R3,??DataTable4  ;; 0x400ff040
   \   0000012E   0x601A             STR      R2,[R3, #+0]
   \   00000130   0xE770             B.N      ??send_byte_2
     78          	}
     79                  
     80                  SDADDR=IIC_IN;    //输入
   \                     ??send_byte_3: (+1)
   \   00000132   0x.... 0x....      LDR.W    R0,??DataTable4_1  ;; 0x400ff054
   \   00000136   0x6800             LDR      R0,[R0, #+0]
   \   00000138   0xF030 0x0002      BICS     R0,R0,#0x2
   \   0000013C   0x.... 0x....      LDR.W    R1,??DataTable4_1  ;; 0x400ff054
   \   00000140   0x6008             STR      R0,[R1, #+0]
     81          	ioi2cnops();
   \   00000142   0xBF00             nop
   \   00000144   0xBF00             nop
   \   00000146   0xBF00             nop
   \   00000148   0xBF00             nop
   \   0000014A   0xBF00             nop
   \   0000014C   0xBF00             nop
   \   0000014E   0xBF00             nop
   \   00000150   0xBF00             nop
   \   00000152   0xBF00             nop
   \   00000154   0xBF00             nop
   \   00000156   0xBF00             nop
   \   00000158   0xBF00             nop
   \   0000015A   0xBF00             nop
   \   0000015C   0xBF00             nop
   \   0000015E   0xBF00             nop
   \   00000160   0xBF00             nop
   \   00000162   0xBF00             nop
   \   00000164   0xBF00             nop
   \   00000166   0xBF00             nop
   \   00000168   0xBF00             nop
   \   0000016A   0xBF00             nop
   \   0000016C   0xBF00             nop
   \   0000016E   0xBF00             nop
   \   00000170   0xBF00             nop
   \   00000172   0xBF00             nop
   \   00000174   0xBF00             nop
   \   00000176   0xBF00             nop
   \   00000178   0xBF00             nop
   \   0000017A   0xBF00             nop
   \   0000017C   0xBF00             nop
   \   0000017E   0xBF00             nop
   \   00000180   0xBF00             nop
   \   00000182   0xBF00             nop
   \   00000184   0xBF00             nop
   \   00000186   0xBF00             nop
   \   00000188   0xBF00             nop
   \   0000018A   0xBF00             nop
   \   0000018C   0xBF00             nop
   \   0000018E   0xBF00             nop
   \   00000190   0xBF00             nop
   \   00000192   0xBF00             nop
   \   00000194   0xBF00             nop
   \   00000196   0xBF00             nop
   \   00000198   0xBF00             nop
   \   0000019A   0xBF00             nop
   \   0000019C   0xBF00             nop
   \   0000019E   0xBF00             nop
   \   000001A0   0xBF00             nop
   \   000001A2   0xBF00             nop
   \   000001A4   0xBF00             nop
     82          	SDA=1; //发送完8bit，释放总线准备接收应答位
   \   000001A6   0x....             LDR.N    R0,??DataTable4  ;; 0x400ff040
   \   000001A8   0x6800             LDR      R0,[R0, #+0]
   \   000001AA   0xF050 0x0002      ORRS     R0,R0,#0x2
   \   000001AE   0x....             LDR.N    R1,??DataTable4  ;; 0x400ff040
   \   000001B0   0x6008             STR      R0,[R1, #+0]
     83          	ioi2cnops();
   \   000001B2   0xBF00             nop
   \   000001B4   0xBF00             nop
   \   000001B6   0xBF00             nop
   \   000001B8   0xBF00             nop
   \   000001BA   0xBF00             nop
   \   000001BC   0xBF00             nop
   \   000001BE   0xBF00             nop
   \   000001C0   0xBF00             nop
   \   000001C2   0xBF00             nop
   \   000001C4   0xBF00             nop
   \   000001C6   0xBF00             nop
   \   000001C8   0xBF00             nop
   \   000001CA   0xBF00             nop
   \   000001CC   0xBF00             nop
   \   000001CE   0xBF00             nop
   \   000001D0   0xBF00             nop
   \   000001D2   0xBF00             nop
   \   000001D4   0xBF00             nop
   \   000001D6   0xBF00             nop
   \   000001D8   0xBF00             nop
   \   000001DA   0xBF00             nop
   \   000001DC   0xBF00             nop
   \   000001DE   0xBF00             nop
   \   000001E0   0xBF00             nop
   \   000001E2   0xBF00             nop
   \   000001E4   0xBF00             nop
   \   000001E6   0xBF00             nop
   \   000001E8   0xBF00             nop
   \   000001EA   0xBF00             nop
   \   000001EC   0xBF00             nop
   \   000001EE   0xBF00             nop
   \   000001F0   0xBF00             nop
   \   000001F2   0xBF00             nop
   \   000001F4   0xBF00             nop
   \   000001F6   0xBF00             nop
   \   000001F8   0xBF00             nop
   \   000001FA   0xBF00             nop
   \   000001FC   0xBF00             nop
   \   000001FE   0xBF00             nop
   \   00000200   0xBF00             nop
   \   00000202   0xBF00             nop
   \   00000204   0xBF00             nop
   \   00000206   0xBF00             nop
   \   00000208   0xBF00             nop
   \   0000020A   0xBF00             nop
   \   0000020C   0xBF00             nop
   \   0000020E   0xBF00             nop
   \   00000210   0xBF00             nop
   \   00000212   0xBF00             nop
   \   00000214   0xBF00             nop
     84          	SCL=1; //
   \   00000216   0x....             LDR.N    R0,??DataTable4  ;; 0x400ff040
   \   00000218   0x6800             LDR      R0,[R0, #+0]
   \   0000021A   0xF050 0x0001      ORRS     R0,R0,#0x1
   \   0000021E   0x....             LDR.N    R1,??DataTable4  ;; 0x400ff040
   \   00000220   0x6008             STR      R0,[R1, #+0]
     85                  ioi2cnops(); //sda上数据即是从应答位 
   \   00000222   0xBF00             nop
   \   00000224   0xBF00             nop
   \   00000226   0xBF00             nop
   \   00000228   0xBF00             nop
   \   0000022A   0xBF00             nop
   \   0000022C   0xBF00             nop
   \   0000022E   0xBF00             nop
   \   00000230   0xBF00             nop
   \   00000232   0xBF00             nop
   \   00000234   0xBF00             nop
   \   00000236   0xBF00             nop
   \   00000238   0xBF00             nop
   \   0000023A   0xBF00             nop
   \   0000023C   0xBF00             nop
   \   0000023E   0xBF00             nop
   \   00000240   0xBF00             nop
   \   00000242   0xBF00             nop
   \   00000244   0xBF00             nop
   \   00000246   0xBF00             nop
   \   00000248   0xBF00             nop
   \   0000024A   0xBF00             nop
   \   0000024C   0xBF00             nop
   \   0000024E   0xBF00             nop
   \   00000250   0xBF00             nop
   \   00000252   0xBF00             nop
   \   00000254   0xBF00             nop
   \   00000256   0xBF00             nop
   \   00000258   0xBF00             nop
   \   0000025A   0xBF00             nop
   \   0000025C   0xBF00             nop
   \   0000025E   0xBF00             nop
   \   00000260   0xBF00             nop
   \   00000262   0xBF00             nop
   \   00000264   0xBF00             nop
   \   00000266   0xBF00             nop
   \   00000268   0xBF00             nop
   \   0000026A   0xBF00             nop
   \   0000026C   0xBF00             nop
   \   0000026E   0xBF00             nop
   \   00000270   0xBF00             nop
   \   00000272   0xBF00             nop
   \   00000274   0xBF00             nop
   \   00000276   0xBF00             nop
   \   00000278   0xBF00             nop
   \   0000027A   0xBF00             nop
   \   0000027C   0xBF00             nop
   \   0000027E   0xBF00             nop
   \   00000280   0xBF00             nop
   \   00000282   0xBF00             nop
   \   00000284   0xBF00             nop
     86                  //while(!SDA);//为确认信息做准备
     87                 /* while(!SDA)//因为调试的时候从没有出现“未收到应答”，但为确保准确，还要加一个信号
     88                  {
     89          	ioi2cnops(); //sda上数据即是从应答位 
     90                  uartPrintf("未收到应答\n");
     91                  }
     92                  uartPrintf("收到从应答\n");
     93                  */
     94                  //外部循环是自己加，不知道读取端口是不是这样
     95             //ack = IIC_OUT;   //因为没有看到他的用途，所以就注释掉了，同上一体
     96                  
     97                  SCL=0; //不考虑从应答位|但要控制好时序
   \   00000286   0x....             LDR.N    R0,??DataTable4  ;; 0x400ff040
   \   00000288   0x6800             LDR      R0,[R0, #+0]
   \   0000028A   0x0840             LSRS     R0,R0,#+1
   \   0000028C   0x0040             LSLS     R0,R0,#+1
   \   0000028E   0x....             LDR.N    R1,??DataTable4  ;; 0x400ff040
   \   00000290   0x6008             STR      R0,[R1, #+0]
     98                  
     99                  SDADDR=IIC_OUT;
   \   00000292   0x....             LDR.N    R0,??DataTable4_1  ;; 0x400ff054
   \   00000294   0x6800             LDR      R0,[R0, #+0]
   \   00000296   0xF050 0x0002      ORRS     R0,R0,#0x2
   \   0000029A   0x....             LDR.N    R1,??DataTable4_1  ;; 0x400ff054
   \   0000029C   0x6008             STR      R0,[R1, #+0]
    100                  ioi2cnops();
   \   0000029E   0xBF00             nop
   \   000002A0   0xBF00             nop
   \   000002A2   0xBF00             nop
   \   000002A4   0xBF00             nop
   \   000002A6   0xBF00             nop
   \   000002A8   0xBF00             nop
   \   000002AA   0xBF00             nop
   \   000002AC   0xBF00             nop
   \   000002AE   0xBF00             nop
   \   000002B0   0xBF00             nop
   \   000002B2   0xBF00             nop
   \   000002B4   0xBF00             nop
   \   000002B6   0xBF00             nop
   \   000002B8   0xBF00             nop
   \   000002BA   0xBF00             nop
   \   000002BC   0xBF00             nop
   \   000002BE   0xBF00             nop
   \   000002C0   0xBF00             nop
   \   000002C2   0xBF00             nop
   \   000002C4   0xBF00             nop
   \   000002C6   0xBF00             nop
   \   000002C8   0xBF00             nop
   \   000002CA   0xBF00             nop
   \   000002CC   0xBF00             nop
   \   000002CE   0xBF00             nop
   \   000002D0   0xBF00             nop
   \   000002D2   0xBF00             nop
   \   000002D4   0xBF00             nop
   \   000002D6   0xBF00             nop
   \   000002D8   0xBF00             nop
   \   000002DA   0xBF00             nop
   \   000002DC   0xBF00             nop
   \   000002DE   0xBF00             nop
   \   000002E0   0xBF00             nop
   \   000002E2   0xBF00             nop
   \   000002E4   0xBF00             nop
   \   000002E6   0xBF00             nop
   \   000002E8   0xBF00             nop
   \   000002EA   0xBF00             nop
   \   000002EC   0xBF00             nop
   \   000002EE   0xBF00             nop
   \   000002F0   0xBF00             nop
   \   000002F2   0xBF00             nop
   \   000002F4   0xBF00             nop
   \   000002F6   0xBF00             nop
   \   000002F8   0xBF00             nop
   \   000002FA   0xBF00             nop
   \   000002FC   0xBF00             nop
   \   000002FE   0xBF00             nop
   \   00000300   0xBF00             nop
    101          }
   \   00000302   0x4770             BX       LR               ;; return
    102          //**************************************************
    103          //字节接收程序
    104          //接收器件传来的数据，此程序应配合|主应答函数|IIC_ack_main()使用
    105          //return: uchar型1字节
    106          //读取字节要是错误的话，那就是ioi2cnops时钟设置不对，但经过测试没有问题

   \                                 In section .text, align 4, keep-with-next
    107          unsigned char read_byte(void)
    108          {
    109                  unsigned char i;
    110                  unsigned char c;
    111          	c=0;
   \                     read_byte: (+1)
   \   00000000   0x2000             MOVS     R0,#+0
    112          	SCL=0;
   \   00000002   0x....             LDR.N    R1,??DataTable4  ;; 0x400ff040
   \   00000004   0x6809             LDR      R1,[R1, #+0]
   \   00000006   0x0849             LSRS     R1,R1,#+1
   \   00000008   0x0049             LSLS     R1,R1,#+1
   \   0000000A   0x....             LDR.N    R2,??DataTable4  ;; 0x400ff040
   \   0000000C   0x6011             STR      R1,[R2, #+0]
    113          	ioi2cnops();
   \   0000000E   0xBF00             nop
   \   00000010   0xBF00             nop
   \   00000012   0xBF00             nop
   \   00000014   0xBF00             nop
   \   00000016   0xBF00             nop
   \   00000018   0xBF00             nop
   \   0000001A   0xBF00             nop
   \   0000001C   0xBF00             nop
   \   0000001E   0xBF00             nop
   \   00000020   0xBF00             nop
   \   00000022   0xBF00             nop
   \   00000024   0xBF00             nop
   \   00000026   0xBF00             nop
   \   00000028   0xBF00             nop
   \   0000002A   0xBF00             nop
   \   0000002C   0xBF00             nop
   \   0000002E   0xBF00             nop
   \   00000030   0xBF00             nop
   \   00000032   0xBF00             nop
   \   00000034   0xBF00             nop
   \   00000036   0xBF00             nop
   \   00000038   0xBF00             nop
   \   0000003A   0xBF00             nop
   \   0000003C   0xBF00             nop
   \   0000003E   0xBF00             nop
   \   00000040   0xBF00             nop
   \   00000042   0xBF00             nop
   \   00000044   0xBF00             nop
   \   00000046   0xBF00             nop
   \   00000048   0xBF00             nop
   \   0000004A   0xBF00             nop
   \   0000004C   0xBF00             nop
   \   0000004E   0xBF00             nop
   \   00000050   0xBF00             nop
   \   00000052   0xBF00             nop
   \   00000054   0xBF00             nop
   \   00000056   0xBF00             nop
   \   00000058   0xBF00             nop
   \   0000005A   0xBF00             nop
   \   0000005C   0xBF00             nop
   \   0000005E   0xBF00             nop
   \   00000060   0xBF00             nop
   \   00000062   0xBF00             nop
   \   00000064   0xBF00             nop
   \   00000066   0xBF00             nop
   \   00000068   0xBF00             nop
   \   0000006A   0xBF00             nop
   \   0000006C   0xBF00             nop
   \   0000006E   0xBF00             nop
   \   00000070   0xBF00             nop
    114          	SDA=1; //置数据线为输入方式
   \   00000072   0x....             LDR.N    R1,??DataTable4  ;; 0x400ff040
   \   00000074   0x6809             LDR      R1,[R1, #+0]
   \   00000076   0xF051 0x0102      ORRS     R1,R1,#0x2
   \   0000007A   0x....             LDR.N    R2,??DataTable4  ;; 0x400ff040
   \   0000007C   0x6011             STR      R1,[R2, #+0]
    115          	SDADDR=IIC_IN;
   \   0000007E   0x....             LDR.N    R1,??DataTable4_1  ;; 0x400ff054
   \   00000080   0x6809             LDR      R1,[R1, #+0]
   \   00000082   0xF031 0x0102      BICS     R1,R1,#0x2
   \   00000086   0x....             LDR.N    R2,??DataTable4_1  ;; 0x400ff054
   \   00000088   0x6011             STR      R1,[R2, #+0]
    116                  ioi2cnops();
   \   0000008A   0xBF00             nop
   \   0000008C   0xBF00             nop
   \   0000008E   0xBF00             nop
   \   00000090   0xBF00             nop
   \   00000092   0xBF00             nop
   \   00000094   0xBF00             nop
   \   00000096   0xBF00             nop
   \   00000098   0xBF00             nop
   \   0000009A   0xBF00             nop
   \   0000009C   0xBF00             nop
   \   0000009E   0xBF00             nop
   \   000000A0   0xBF00             nop
   \   000000A2   0xBF00             nop
   \   000000A4   0xBF00             nop
   \   000000A6   0xBF00             nop
   \   000000A8   0xBF00             nop
   \   000000AA   0xBF00             nop
   \   000000AC   0xBF00             nop
   \   000000AE   0xBF00             nop
   \   000000B0   0xBF00             nop
   \   000000B2   0xBF00             nop
   \   000000B4   0xBF00             nop
   \   000000B6   0xBF00             nop
   \   000000B8   0xBF00             nop
   \   000000BA   0xBF00             nop
   \   000000BC   0xBF00             nop
   \   000000BE   0xBF00             nop
   \   000000C0   0xBF00             nop
   \   000000C2   0xBF00             nop
   \   000000C4   0xBF00             nop
   \   000000C6   0xBF00             nop
   \   000000C8   0xBF00             nop
   \   000000CA   0xBF00             nop
   \   000000CC   0xBF00             nop
   \   000000CE   0xBF00             nop
   \   000000D0   0xBF00             nop
   \   000000D2   0xBF00             nop
   \   000000D4   0xBF00             nop
   \   000000D6   0xBF00             nop
   \   000000D8   0xBF00             nop
   \   000000DA   0xBF00             nop
   \   000000DC   0xBF00             nop
   \   000000DE   0xBF00             nop
   \   000000E0   0xBF00             nop
   \   000000E2   0xBF00             nop
   \   000000E4   0xBF00             nop
   \   000000E6   0xBF00             nop
   \   000000E8   0xBF00             nop
   \   000000EA   0xBF00             nop
   \   000000EC   0xBF00             nop
    117          	for(i=0;i<8;i++)
   \   000000EE   0x2100             MOVS     R1,#+0
   \   000000F0   0xE078             B.N      ??read_byte_0
    118                  {
    119                      SCL=1; //置时钟线为高，使数据线上数据有效
   \                     ??read_byte_1: (+1)
   \   000000F2   0x....             LDR.N    R2,??DataTable4  ;; 0x400ff040
   \   000000F4   0x6812             LDR      R2,[R2, #+0]
   \   000000F6   0xF052 0x0201      ORRS     R2,R2,#0x1
   \   000000FA   0x....             LDR.N    R3,??DataTable4  ;; 0x400ff040
   \   000000FC   0x601A             STR      R2,[R3, #+0]
    120                      ioi2cnops();
   \   000000FE   0xBF00             nop
   \   00000100   0xBF00             nop
   \   00000102   0xBF00             nop
   \   00000104   0xBF00             nop
   \   00000106   0xBF00             nop
   \   00000108   0xBF00             nop
   \   0000010A   0xBF00             nop
   \   0000010C   0xBF00             nop
   \   0000010E   0xBF00             nop
   \   00000110   0xBF00             nop
   \   00000112   0xBF00             nop
   \   00000114   0xBF00             nop
   \   00000116   0xBF00             nop
   \   00000118   0xBF00             nop
   \   0000011A   0xBF00             nop
   \   0000011C   0xBF00             nop
   \   0000011E   0xBF00             nop
   \   00000120   0xBF00             nop
   \   00000122   0xBF00             nop
   \   00000124   0xBF00             nop
   \   00000126   0xBF00             nop
   \   00000128   0xBF00             nop
   \   0000012A   0xBF00             nop
   \   0000012C   0xBF00             nop
   \   0000012E   0xBF00             nop
   \   00000130   0xBF00             nop
   \   00000132   0xBF00             nop
   \   00000134   0xBF00             nop
   \   00000136   0xBF00             nop
   \   00000138   0xBF00             nop
   \   0000013A   0xBF00             nop
   \   0000013C   0xBF00             nop
   \   0000013E   0xBF00             nop
   \   00000140   0xBF00             nop
   \   00000142   0xBF00             nop
   \   00000144   0xBF00             nop
   \   00000146   0xBF00             nop
   \   00000148   0xBF00             nop
   \   0000014A   0xBF00             nop
   \   0000014C   0xBF00             nop
   \   0000014E   0xBF00             nop
   \   00000150   0xBF00             nop
   \   00000152   0xBF00             nop
   \   00000154   0xBF00             nop
   \   00000156   0xBF00             nop
   \   00000158   0xBF00             nop
   \   0000015A   0xBF00             nop
   \   0000015C   0xBF00             nop
   \   0000015E   0xBF00             nop
   \   00000160   0xBF00             nop
    121                      c<<=1;
   \   00000162   0x0040             LSLS     R0,R0,#+1
    122                      if(SDA_IN)c+=1; //读数据位，将接收的数据存c
   \   00000164   0x....             LDR.N    R2,??DataTable4_2  ;; 0x400ff050
   \   00000166   0x6812             LDR      R2,[R2, #+0]
   \   00000168   0xF3C2 0x0240      UBFX     R2,R2,#+1,#+1
   \   0000016C   0x2A00             CMP      R2,#+0
   \   0000016E   0xD000             BEQ.N    ??read_byte_2
   \   00000170   0x1C40             ADDS     R0,R0,#+1
    123                      SCL=0; //置时钟线为低，准备接收数据位
   \                     ??read_byte_2: (+1)
   \   00000172   0x....             LDR.N    R2,??DataTable4  ;; 0x400ff040
   \   00000174   0x6812             LDR      R2,[R2, #+0]
   \   00000176   0x0852             LSRS     R2,R2,#+1
   \   00000178   0x0052             LSLS     R2,R2,#+1
   \   0000017A   0x....             LDR.N    R3,??DataTable4  ;; 0x400ff040
   \   0000017C   0x601A             STR      R2,[R3, #+0]
    124                      ioi2cnops();
   \   0000017E   0xBF00             nop
   \   00000180   0xBF00             nop
   \   00000182   0xBF00             nop
   \   00000184   0xBF00             nop
   \   00000186   0xBF00             nop
   \   00000188   0xBF00             nop
   \   0000018A   0xBF00             nop
   \   0000018C   0xBF00             nop
   \   0000018E   0xBF00             nop
   \   00000190   0xBF00             nop
   \   00000192   0xBF00             nop
   \   00000194   0xBF00             nop
   \   00000196   0xBF00             nop
   \   00000198   0xBF00             nop
   \   0000019A   0xBF00             nop
   \   0000019C   0xBF00             nop
   \   0000019E   0xBF00             nop
   \   000001A0   0xBF00             nop
   \   000001A2   0xBF00             nop
   \   000001A4   0xBF00             nop
   \   000001A6   0xBF00             nop
   \   000001A8   0xBF00             nop
   \   000001AA   0xBF00             nop
   \   000001AC   0xBF00             nop
   \   000001AE   0xBF00             nop
   \   000001B0   0xBF00             nop
   \   000001B2   0xBF00             nop
   \   000001B4   0xBF00             nop
   \   000001B6   0xBF00             nop
   \   000001B8   0xBF00             nop
   \   000001BA   0xBF00             nop
   \   000001BC   0xBF00             nop
   \   000001BE   0xBF00             nop
   \   000001C0   0xBF00             nop
   \   000001C2   0xBF00             nop
   \   000001C4   0xBF00             nop
   \   000001C6   0xBF00             nop
   \   000001C8   0xBF00             nop
   \   000001CA   0xBF00             nop
   \   000001CC   0xBF00             nop
   \   000001CE   0xBF00             nop
   \   000001D0   0xBF00             nop
   \   000001D2   0xBF00             nop
   \   000001D4   0xBF00             nop
   \   000001D6   0xBF00             nop
   \   000001D8   0xBF00             nop
   \   000001DA   0xBF00             nop
   \   000001DC   0xBF00             nop
   \   000001DE   0xBF00             nop
   \   000001E0   0xBF00             nop
    125          	}
   \   000001E2   0x1C49             ADDS     R1,R1,#+1
   \                     ??read_byte_0: (+1)
   \   000001E4   0xB2C9             UXTB     R1,R1            ;; ZeroExt  R1,R1,#+24,#+24
   \   000001E6   0x2908             CMP      R1,#+8
   \   000001E8   0xDB83             BLT.N    ??read_byte_1
    126          	SCL=0;
   \   000001EA   0x....             LDR.N    R1,??DataTable4  ;; 0x400ff040
   \   000001EC   0x6809             LDR      R1,[R1, #+0]
   \   000001EE   0x0849             LSRS     R1,R1,#+1
   \   000001F0   0x0049             LSLS     R1,R1,#+1
   \   000001F2   0x....             LDR.N    R2,??DataTable4  ;; 0x400ff040
   \   000001F4   0x6011             STR      R1,[R2, #+0]
    127          	SDADDR=IIC_OUT;
   \   000001F6   0x....             LDR.N    R1,??DataTable4_1  ;; 0x400ff054
   \   000001F8   0x6809             LDR      R1,[R1, #+0]
   \   000001FA   0xF051 0x0102      ORRS     R1,R1,#0x2
   \   000001FE   0x....             LDR.N    R2,??DataTable4_1  ;; 0x400ff054
   \   00000200   0x6011             STR      R1,[R2, #+0]
    128          	return c;
   \   00000202   0xB2C0             UXTB     R0,R0            ;; ZeroExt  R0,R0,#+24,#+24
   \   00000204   0x4770             BX       LR               ;; return
    129          }
    130          //***************************************************
    131          //向无子地址器件发送单字节数据

   \                                 In section .text, align 2, keep-with-next
    132          void send_to_byte(unsigned char ad_main,unsigned char c){
   \                     send_to_byte: (+1)
   \   00000000   0xB538             PUSH     {R3-R5,LR}
   \   00000002   0x0004             MOVS     R4,R0
   \   00000004   0x000D             MOVS     R5,R1
    133          	IIC_start();
   \   00000006   0x.... 0x....      BL       IIC_start
    134          	send_byte(ad_main); //发送器件地址
   \   0000000A   0x0020             MOVS     R0,R4
   \   0000000C   0xB2C0             UXTB     R0,R0            ;; ZeroExt  R0,R0,#+24,#+24
   \   0000000E   0x.... 0x....      BL       send_byte
    135          	send_byte(c); //发送数据c
   \   00000012   0x0028             MOVS     R0,R5
   \   00000014   0xB2C0             UXTB     R0,R0            ;; ZeroExt  R0,R0,#+24,#+24
   \   00000016   0x.... 0x....      BL       send_byte
    136          	IIC_stop();
   \   0000001A   0x.... 0x....      BL       IIC_stop
    137          }
   \   0000001E   0xBD31             POP      {R0,R4,R5,PC}    ;; return
    138          //***************************************************
    139          //向有子地址器件发送多字节数据

   \                                 In section .text, align 2, keep-with-next
    140          void send_to_nbyte(unsigned char ad_main,unsigned char ad_sub,unsigned char *buf,unsigned char num){
   \                     send_to_nbyte: (+1)
   \   00000000   0xB5F8             PUSH     {R3-R7,LR}
   \   00000002   0x0004             MOVS     R4,R0
   \   00000004   0x000D             MOVS     R5,R1
   \   00000006   0x0016             MOVS     R6,R2
   \   00000008   0x001F             MOVS     R7,R3
    141          	unsigned char i;
    142          	IIC_start();
   \   0000000A   0x.... 0x....      BL       IIC_start
    143          	send_byte(ad_main); //发送器件地址
   \   0000000E   0x0020             MOVS     R0,R4
   \   00000010   0xB2C0             UXTB     R0,R0            ;; ZeroExt  R0,R0,#+24,#+24
   \   00000012   0x.... 0x....      BL       send_byte
    144          	send_byte(ad_sub); //发送器件子地址
   \   00000016   0x0028             MOVS     R0,R5
   \   00000018   0xB2C0             UXTB     R0,R0            ;; ZeroExt  R0,R0,#+24,#+24
   \   0000001A   0x.... 0x....      BL       send_byte
    145          	for(i=0;i<num;i++){
   \   0000001E   0x2400             MOVS     R4,#+0
   \   00000020   0xE004             B.N      ??send_to_nbyte_0
    146          		send_byte(*buf); //发送数据*buf
   \                     ??send_to_nbyte_1: (+1)
   \   00000022   0x7830             LDRB     R0,[R6, #+0]
   \   00000024   0x.... 0x....      BL       send_byte
    147          		buf++;
   \   00000028   0x1C76             ADDS     R6,R6,#+1
    148          	}
   \   0000002A   0x1C64             ADDS     R4,R4,#+1
   \                     ??send_to_nbyte_0: (+1)
   \   0000002C   0xB2E4             UXTB     R4,R4            ;; ZeroExt  R4,R4,#+24,#+24
   \   0000002E   0xB2FF             UXTB     R7,R7            ;; ZeroExt  R7,R7,#+24,#+24
   \   00000030   0x42BC             CMP      R4,R7
   \   00000032   0xD3F6             BCC.N    ??send_to_nbyte_1
    149          	IIC_stop();
   \   00000034   0x.... 0x....      BL       IIC_stop
    150          }
   \   00000038   0xBDF1             POP      {R0,R4-R7,PC}    ;; return
    151          //***************************************************
    152          //从无子地址器件读单字节数据
    153          //function:器件地址，所读数据存在接收缓冲区当前字节

   \                                 In section .text, align 2, keep-with-next
    154          void read_from_byte(unsigned char ad_main,unsigned char *buf){
   \                     read_from_byte: (+1)
   \   00000000   0xB538             PUSH     {R3-R5,LR}
   \   00000002   0x0004             MOVS     R4,R0
   \   00000004   0x000D             MOVS     R5,R1
    155          	IIC_start();
   \   00000006   0x.... 0x....      BL       IIC_start
    156          	send_byte(ad_main); //发送器件地址
   \   0000000A   0x0020             MOVS     R0,R4
   \   0000000C   0xB2C0             UXTB     R0,R0            ;; ZeroExt  R0,R0,#+24,#+24
   \   0000000E   0x.... 0x....      BL       send_byte
    157          	*buf=read_byte();
   \   00000012   0x.... 0x....      BL       read_byte
   \   00000016   0x7028             STRB     R0,[R5, #+0]
    158          	IIC_ack_main(no_ack); //无需应答<no_ack=0>
   \   00000018   0x2000             MOVS     R0,#+0
   \   0000001A   0x.... 0x....      BL       IIC_ack_main
    159          	IIC_stop();
   \   0000001E   0x.... 0x....      BL       IIC_stop
    160          }
   \   00000022   0xBD31             POP      {R0,R4,R5,PC}    ;; return
    161          //***************************************************
    162          //从有子地址器件读多个字节数据
    163          //function:

   \                                 In section .text, align 2, keep-with-next
    164          void read_from_nbyte(unsigned char ad_main,unsigned char ad_sub,unsigned char *buf,unsigned char num){
   \                     read_from_nbyte: (+1)
   \   00000000   0xB5F8             PUSH     {R3-R7,LR}
   \   00000002   0x0004             MOVS     R4,R0
   \   00000004   0x000D             MOVS     R5,R1
   \   00000006   0x0016             MOVS     R6,R2
   \   00000008   0x001F             MOVS     R7,R3
    165          	unsigned char i;
    166          	IIC_start();
   \   0000000A   0x.... 0x....      BL       IIC_start
    167          	send_byte(ad_main);
   \   0000000E   0x0020             MOVS     R0,R4
   \   00000010   0xB2C0             UXTB     R0,R0            ;; ZeroExt  R0,R0,#+24,#+24
   \   00000012   0x.... 0x....      BL       send_byte
    168          	send_byte(ad_sub);
   \   00000016   0x0028             MOVS     R0,R5
   \   00000018   0xB2C0             UXTB     R0,R0            ;; ZeroExt  R0,R0,#+24,#+24
   \   0000001A   0x.... 0x....      BL       send_byte
    169          	for(i=0;i<num-1;i++){
   \   0000001E   0x2400             MOVS     R4,#+0
   \   00000020   0xE007             B.N      ??read_from_nbyte_0
    170          		*buf=read_byte();
   \                     ??read_from_nbyte_1: (+1)
   \   00000022   0x.... 0x....      BL       read_byte
   \   00000026   0x7030             STRB     R0,[R6, #+0]
    171          		IIC_ack_main(ack); //主应答<ack=1>
   \   00000028   0x2001             MOVS     R0,#+1
   \   0000002A   0x.... 0x....      BL       IIC_ack_main
    172          		buf++;
   \   0000002E   0x1C76             ADDS     R6,R6,#+1
    173          	}
   \   00000030   0x1C64             ADDS     R4,R4,#+1
   \                     ??read_from_nbyte_0: (+1)
   \   00000032   0xB2E4             UXTB     R4,R4            ;; ZeroExt  R4,R4,#+24,#+24
   \   00000034   0xB2FF             UXTB     R7,R7            ;; ZeroExt  R7,R7,#+24,#+24
   \   00000036   0x1E78             SUBS     R0,R7,#+1
   \   00000038   0x4284             CMP      R4,R0
   \   0000003A   0xDBF2             BLT.N    ??read_from_nbyte_1
    174          	*buf=read_byte();
   \   0000003C   0x.... 0x....      BL       read_byte
   \   00000040   0x7030             STRB     R0,[R6, #+0]
    175          	buf++; //本次指针调整无意义，目的是操作后buf指向下一地址
   \   00000042   0x1C76             ADDS     R6,R6,#+1
    176          	IIC_ack_main(no_ack); //无需应答<no_ack=0>
   \   00000044   0x2000             MOVS     R0,#+0
   \   00000046   0x.... 0x....      BL       IIC_ack_main
    177          	IIC_stop();
   \   0000004A   0x.... 0x....      BL       IIC_stop
    178          }
   \   0000004E   0xBDF1             POP      {R0,R4-R7,PC}    ;; return

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable4:
   \   00000000   0x400FF040         DC32     0x400ff040

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable4_1:
   \   00000000   0x400FF054         DC32     0x400ff054

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable4_2:
   \   00000000   0x400FF050         DC32     0x400ff050
    179          
    180          
    181          #endif
    182          
    183          #ifdef SCCB
    184          /*************************************************
    185          Function: SCCB_Wait
    186          Description: delay
    187          Input: no
    188          Output: no
    189          More:no
    190          *************************************************/
    191          void SCCB_Wait(void)    
    192          {
    193            unsigned int i;
    194          
    195            for(i=0;i<600;i++)  //20us
    196            {
    197              //asm("nop");
    198            }
    199          }
    200          
    201          /*************************************************
    202          Function: SCCB_Start
    203          Description: signal of start
    204          Input: no
    205          Output: no
    206          More:no
    207          *************************************************/
    208          void SCCB_Start(void)   
    209          {
    210            SDA_DR=SCCB_OUT;
    211            SDA = 1;
    212            SCL = 1;
    213            SCCB_Wait();
    214            SDA = 0;
    215            SCCB_Wait();
    216            SCL = 0;
    217          }
    218          
    219          /*************************************************
    220          Function: SCCB_Stop
    221          Description: signal of stop
    222          Input: no
    223          Output: no
    224          More:no
    225          *************************************************/
    226          void SCCB_Stop(void)    
    227          {
    228            SCL = 0;
    229            SDA_DR=SCCB_OUT;
    230            SDA = 0;
    231            SCCB_Wait();
    232            SCL = 1;
    233            SCCB_Wait();   //时钟高电平下，数据从0-》1
    234            SDA = 1;
    235            SCCB_Wait();
    236          }
    237          
    238          /*************************************************
    239          Function: SCCB_SendAck
    240          Description: send ack to slave
    241          Input: signal of ack
    242          Output: no
    243          More:no
    244          *************************************************/
    245          void SCCB_SendAck(byte ack)  
    246          {
    247            SDA_DR=SCCB_OUT;
    248            SDA = ack;
    249            SCL = 1;
    250            SCCB_Wait();
    251            SCL = 0;
    252          }
    253          
    254          /*************************************************
    255          Function: SCCB_SendByte
    256          Description: send data  to SCCB register
    257          Input: byte of data
    258          Output: return ack  1:receive ack  0:no ack
    259          More:no
    260          *************************************************/
    261          byte SCCB_SendByte(unsigned char bytedata) 
    262          {
    263            unsigned char i;
    264            byte ack;
    265            SDA_DR=SCCB_OUT;
    266            for(i=0;i<8;i++)
    267            {
    268              SCL = 0;
    269              SCCB_Wait();
    270              
    271              if(bytedata & 0x80)
    272                SDA = 1;
    273              else
    274                SDA = 0;
    275          
    276              bytedata <<= 1;
    277              SCCB_Wait();
    278          
    279              SCL = 1;
    280              SCCB_Wait();
    281              SCL = 0;
    282              
    283            }
    284            SCCB_Wait();
    285            SDA = 1;
    286            SDA_DR=SCCB_IN;
    287            SCCB_Wait();
    288            SCL = 1;
    289            SCCB_Wait();
    290          
    291            ack = SCCB_IN;    
    292          
    293            SCL = 0;
    294            SCCB_Wait();
    295          
    296            SDA_DR=SCCB_OUT;
    297            return ack;
    298          }
    299          
    300          
    301          /******************************************************
    302          Function: SCCB_ReceiveByte
    303          Description: receive data  from SCCB register
    304          Input: no
    305          Output: data 
    306          More:no
    307          ********************************************************/
    308          unsigned char SCCB_ReceiveByte(void)  
    309          {
    310            unsigned char i;
    311            unsigned char bytedata = 0;
    312            SDA_DR=SCCB_IN;
    313            for(i=0;i<8;i++)
    314            {
    315              SCL = 1;
    316              SCCB_Wait();
    317          
    318              bytedata <<= 1;
    319          
    320              if(SDA_IN)
    321              {
    322                bytedata |= 0x01;
    323              }
    324              SCL = 0;
    325              SCCB_Wait();
    326            }
    327           
    328            SDA_DR=SCCB_OUT;
    329            return bytedata;
    330          }
    331          
    332          /******************************************************
    333          Function: SCCB_ByteWrite
    334          Description: write the data to the address 
    335          Input: device  0xC0  write to  OV6620
    336                         0XC1  read from OV6620
    337                         0x42  write to  OV7620
    338                         0x43  read from OV7620
    339          Output: no
    340          More:no
    341          ********************************************************/
    342          
    343          void SCCB_ByteWrite(unsigned char device,unsigned char address,unsigned char bytedata)
    344          {     
    345             SCCB_Start();
    346             
    347             SCCB_SendByte(device);
    348             
    349             SCCB_SendByte(address);
    350             
    351             SCCB_SendByte(bytedata);
    352             
    353             SCCB_Stop();
    354          
    355          }
    356          
    357          
    358          unsigned char SCCB_ByteRead(unsigned char device,unsigned char address)  
    359          {
    360            unsigned char bytedata = 0;
    361            
    362            SCCB_Start();
    363            
    364            SCCB_SendByte(device);
    365            
    366            SCCB_SendByte(address);
    367            
    368            SCCB_Stop();
    369            
    370            SCCB_Start();
    371            
    372            SCCB_SendByte(device+1);
    373            
    374            bytedata = SCCB_ReceiveByte();
    375            
    376            SCCB_SendAck(1)  ;
    377            
    378            SCCB_Stop();
    379            
    380            
    381            return bytedata;
    382          }
    383          #endif

   Maximum stack usage in bytes:

   .cstack Function
   ------- --------
       0   IIC_ack_main
       0   IIC_start
       0   IIC_stop
       0   read_byte
      16   read_from_byte
        16   -> IIC_ack_main
        16   -> IIC_start
        16   -> IIC_stop
        16   -> read_byte
        16   -> send_byte
      24   read_from_nbyte
        24   -> IIC_ack_main
        24   -> IIC_start
        24   -> IIC_stop
        24   -> read_byte
        24   -> send_byte
       0   send_byte
      16   send_to_byte
        16   -> IIC_start
        16   -> IIC_stop
        16   -> send_byte
      24   send_to_nbyte
        24   -> IIC_start
        24   -> IIC_stop
        24   -> send_byte


   Section sizes:

   Bytes  Function/Label
   -----  --------------
       4  ??DataTable4
       4  ??DataTable4_1
       4  ??DataTable4_2
     290  IIC_ack_main
       1  IIC_ad_main
       1  IIC_ad_sub
       4  IIC_buf
       1  IIC_num
     382  IIC_start
     482  IIC_stop
     518  read_byte
      36  read_from_byte
      80  read_from_nbyte
     772  send_byte
      32  send_to_byte
      58  send_to_nbyte

 
     7 bytes in section .bss
 2 662 bytes in section .text
 
 2 662 bytes of CODE memory
     7 bytes of DATA memory

Errors: none
Warnings: none
